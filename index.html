<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Lucuma - A Web Components library for ClojureScript</title>
    <script src="assets/platform.js"></script>
    <script src="assets/spin.min.js"></script>
    <script src="assets/ladda.min.js"></script>
    <script src="assets/lucuma+examples.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
    <script src="assets/prism.js"></script>
    <script src="assets/prism.clojure.js"></script>
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css">
    <link rel="stylesheet" href="assets/prism.css">
    <link rel="stylesheet" href="assets/screen.css">
    <link rel="stylesheet" href="assets/ladda-themeless.min.css">
  </head>
  <body data-spy="scroll" data-target="#navbar">

    <a href="https://github.com/jeluard/lucuma">
      <img id="ribbon" src="http://aral.github.io/fork-me-on-github-retina-ribbons/right-dusk-blue@2x.png" alt="Fork me on GitHub">
    </a>
    <iframe id="github-button" src="http://ghbtns.com/github-btn.html?user=jeluard&repo=lucuma&type=watch&count=true"
allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>
    <nav id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#"><strong>LUCUMA</strong></a>
      </div>
      <div class="collapse navbar-collapse navbar-ex1-collapse">
        <ul class="nav navbar-nav">
          <li class="active"><a href="#introduction">Introduction</a></li>
          <li><a href="#installation">Installation</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Usage <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="#custom-element-definition">Custom Element definition</a></li>
              <li><a href="#custom-element-lifecycle">Lifecycle</a></li>
              <li><a href="#custom-element-content">Content</a></li>
              <li><a href="#custom-element-style">Style</a></li>
              <li><a href="#custom-element-attributes">Attributes</a></li>
              <li><a href="#custom-element-methods">Methods</a></li>
              <li><a href="#custom-element-events">Events</a></li>
              <li><a href="#custom-element-constructor">Constructor</a></li>
              <li><a href="#custom-element-extend">Extension</a></li>
            </ul>
          </li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="#example-range-with-threshold">Range with threshold</a></li>
              <li><a href="#example-overlay">Overlay</a></li>
              <!--li><a href="#example-flipbox">Flipbox</a></li-->
            </ul>
          </li>
          <li><a href="#tests">Tests</a></li>
          <li><a href="#native-browser-support">Native browser support</a></li>
          <li><a href="#links">Links</a></li>
        </ul>
      </div>
    </nav>
    
    <main class="container">
      <section id="introduction" class="main-section">
        <div class="lead">
          <p>A Web Components library for <a href="http://clojurescript.com">ClojureScript</a>.</p>
          <p>
            At its core lucuma helps with creating your own HTML element tag (Web Component) encapsulating content, style and logic. It is <strong>not</strong> a fancy <em>MV*</em> framework and aims at being a thin layer building on top of next generation web standards (mainly <span class="text-muted">Custom Elements</span>, <span class="text-muted">Shadow DOM</span> and <span class="text-muted">HTML Template</span>).
            <br>
            It also makes the extra effort of being flexible and open to existing ClojureScript standards and libraries.</p>
          <p>
            Lucuma is conceptually similar to <a href="http://www.polymer-project.org/">polymer</a>, <a href="http://www.x-tags.org/">x-tags</a> or <a href="https://www.dartlang.org/polymer-dart/">Polymer.dart</a>.
          </p>
        </div>
        <div class="disclaimer">
          <h4>Disclaimer</h4>
          <p>Technologies involved are pre-alpha (specs are not frozen yet). Use cautiously!</p>
        </div>
      </section>
    
      <section id="installation" class="main-section">
        <h1>Installation</h1>
        <p>Lucuma is available in <a href="https://clojars.org/lucuma">Clojars</a>. Add <strong>[lucuma "0.1.0"]</strong> dependency to your <strong>project.clj</strong>.</p>
        <div class="info">
          <h4>Browser support</h4>
          <p>Unless you target browsers with <a href="#native-browser-support">native</a> custom elements support you will need to use a polyfill.</p>
          <p>
            <a href="http://www.polymer-project.org/getting-the-code.html">Polymer</a> is one of the stronger alternative.
            Use it by adding <code class="language-markup">&lt;script src="platform.min.js"&gt;&lt;/script&gt;</code> to your html head (check <a href="http://www.polymer-project.org/build/">build reports</a> for browser support).
            </p>
        </div>
      </section>

      <section id="usage" class="main-section">
          <h1>Usage</h1>

          <section id="custom-element-definition">
            <h2>Custom Element definition</h2>
            <p>
              Custom elements are defined as maps of keyword / value. This map serves as the abstract definition for the element prototype. Once registered the element can be manipulated by the DOM.
              Element instances have <strong>lucuma.LucumaElement</strong> in their prototype chain.
            </p>
            <p>
              For encapsulation purpoise content and style are appended to a Shadow DOM.
            </p>
            <div class="example-live">
              <ex-hello></ex-hello>
            </div>
            <pre class="example-markup">
              <code class="language-markup">
  &lt;ex-hello&gt;&lt;/ex-hello&gt;
              </code>
            </pre>
            <pre class="example-cljs">
              <code class="language-clojure">
  (use 'lucuma)
  (defwebcomponent ex-hello
    :content "Hello World!")
  
  (register ex-hello)
              </code>
            </pre>
  
            <p>
             Custom Elements can be manipulated programmatically as any other regular element.
            </p>
            <pre class="example-cljs">
              <code class="language-clojure">
  ;;append a my-element node to body
  (.appendChild js/document.body (.createElement js/document "my-element"))
  
  ;;or using hiccup syntax and dommy
  (dommy/append! (dommy/sel1 :body) [:my-element])
              </code>
            </pre>
          </section>

          <section id="custom-element-lifecycle">
            <h2>Lifecycle</h2>
            <p>Custom Elements define lifecycle callbacks that hook on element instance <strong>creation</strong>, view <strong>insertion</strong> and view <strong>removal</strong>.</p>
            <p>You can hook function to the element lifecycle using following keys:</p>
            <ul>
              <li><strong>created-fn</strong> called when an instance of the component is created (e.g. via <strong>document.createElement</strong>)</li>
              <li><strong>entered-view-fn</strong> called after an instance of the component entered the view (i.e. has been inserted)</li>
              <li><strong>left-view-fn</strong> called after an instance of the component left the view (i.e. has been removed)</li>
            </ul>
            <p>All functions receive as unique argument the element instance.</p>
            <div class="example-live">
              <script>
              var e;
              function createLifecycle() {
                e = document.createElement('ex-lifecycle');
                document.getElementById('btn-append').disabled = false;
                document.getElementById('btn-remove').disabled = true;
              }
              function appendLifecycle() {
                document.body.appendChild(e);
                document.getElementById('btn-append').disabled = false;
                document.getElementById('btn-remove').disabled = true;
              }
              function removeLifecycle() {
                document.body.removeChild(e);
                document.getElementById('btn-append').disabled = false;
                document.getElementById('btn-remove').disabled = true;
              }
              </script>
              <div class="btn-group" style="float: left;">
                <button type="button" class="btn btn-default" onclick="createLifecycle()">Create</button>
                <button id="btn-append" type="button" class="btn btn-success" onclick="appendLifecycle()" disabled>Append</button>
                <button id="btn-remove" type="button" class="btn btn-danger" onclick="removeLifecycle()" disabled>Remove</button>
              </div>
              <ul id="lifecycle-events" style="height: 40px; width: 200px; overflow-y: auto;"></ul>
            </div>
            <pre class="example-cljs">
              <code class="language-clojure">
  (defwebcomponent ex-lifecycle
    :created-fn #(prepend! (sel1 :#lifecycle-events) [:li "element created"])
    :entered-view-fn #(prepend! (sel1 :#lifecycle-events) [:li "element entered view"])
    :left-view-fn #(prepend! (sel1 :#lifecycle-events) [:li "element left view"]))
              </code>
            </pre>
          </section>

          <section id="custom-element-content">
            <h2>Content</h2>
            <p>
              Content of a Web Component comes from the <strong>content</strong> value that will be rendered based on its type then appended to the element internal ShadowRoot. This process is triggered per instance during the <a href="#custom-element-lifecycle">creation phase</a>.
            </p>
            <p>The rendering process consists of:</p>
            <ol>
              <li>if content is a function evaluate it; otherwise use content value as-is</li>
              <li>call <a href="https://github.com/jeluard/lucuma/blob/master/src/lucuma.cljs#L27">render-content</a> multimethod (dispatch on content type) to generate the rendered html</li>
              <li>call <a href="https://github.com/jeluard/lucuma/blob/master/src/lucuma.cljs#L38">append-content!</a> multimethod (dispatch on rendered content type) to insert content in the DOM</li>
            </ol>
            <p>
            <p>
              <strong>render-content</strong> has implementations for String (identity) and <a href="#custom-element-template-support">HTML Template</a>.
              <br>
              <strong>append-content!</strong> has implementations for String (set as <strong>innerHTML</strong>), any <strong>HTMLElement</strong> and <strong>DocumentFragment</strong> (both appended to the ShadowRoot).
            </p>
            <div class="example-live">
              <ex-hello></ex-hello>
            </div>
            <pre class="example-cljs">
              <code class="language-clojure">
  (defwebcomponent ex-hello
    :content "Hello world!")
              </code>
            </pre>

            <section id="custom-element-template-support">
              <h4>Template support</h4>
              <p>
                <a href="http://docs.webplatform.org/wiki/html/elements/template">HTML template</a> can be directly used as content (its content will be cloned during the <a href="#custom-element-lifecycle">creation phase</a>):
              </p>
              <div class="example-live">
                <template id="template-id">
                  <div>Hello template!</div>
                </template>
                <ex-content-template></ex-content-template>
              </div>
              <pre class="example-markup">
                <code class="language-markup">
    &lt;template id="template-id"&gt;
      &lt;div&gt;Hello template!&lt;/div&gt;
    &lt;/template&gt;
    &lt;ex-content-template&gt;&lt;/ex-content-template&gt;
                </code>
              </pre>
              <pre class="example-cljs">
                <code class="language-clojure">
    (defwebcomponent ex-content-template
      :content #(dommy.macros/sel1 :#template-id))
                </code>
              </pre>
            </section>

            <section id="custom-element-content-custom-logic">
              <h4>Custom logic support</h4>
              <p>
                As rendering is delegated to the render-content multimethod custom logic can be hooked. A common use-case is to use a <a href="https://github.com/weavejester/hiccup">hiccup</a> implementation (such as <a href="https://github.com/Prismatic/dommy">dommy</a>, <a href="https://github.com/ibdknox/crate/">crate</a>, <a href="https://github.com/lynaghk/singult">singult</a> or <a href="https://github.com/teropa/hiccups">hiccups</a>) to render vectors.
              </p>
              <div class="example-live">
                <ex-content-hiccup></ex-content-hiccup>
              </div>
              <pre class="example-cljs">
                <code class="language-clojure">
    ;; Use dommy.macros/node to render hiccup style vector as a DocumentFragment.

    (derive PersistentVector ::vector)
    (defmethod render-content ::vector [v] (node v))

    (defwebcomponent ex-content-hiccup
      :content [:div "Hello hiccup!"])
                </code>
              </pre>
            </section>

          </section>

          <section id="custom-element-style">
            <h2>Style</h2>
            <p>Style is treated similarly to <a href="custom-element-content">content</a>.
            <p>The rendering process consists of:</p>
            <ol>
              <li>if style is a function evaluate it; otherwise use style value as-is</li>
              <li>call <a href="https://github.com/jeluard/lucuma/blob/master/src/lucuma.cljs#L47">render-style</a> multimethod (dispatch on content type) to generate the rendered html</li>
              <li>call <a href="https://github.com/jeluard/lucuma/blob/master/src/lucuma.cljs#L54">append-style!</a> multimethod (dispatch on rendered style type) to insert content in the DOM</li>
            </ol>
            <p>
            <p>
              <strong>render-style</strong> has implementations for String (identity).
              <br>
              <strong>append-style!</strong> has an implementation for String (set as <strong>textContent</strong> of a newly created <strong>style</strong> element, itself appended to the ShadowRoot).
            </p>
            <div class="example-live">
              <ex-style></ex-style>
            </div>
            <pre class="example-cljs">
              <code class="language-clojure">
  (defwebcomponent ex-style
    :content [:button "Hello styled!"]
    :style "button {background: blue; color: white; border: 0; border-radius: 4px;}")
              </code>
            </pre>

            <section>
              <h4 id="custom-element-style-custom-logic">Custom logic support</h4>
              <p>
                As rendering is delegated to the render-style multimethod custom logic can be hooked. A common use-case is to use a <a href="https://github.com/noprompt/garden">garden</a> to render vectors.
              </p>
              <div class="example-live">
                <ex-style-garden></ex-style-garden>
              </div>
              <pre class="example-cljs">
                <code class="language-clojure">
    ;; Use garden.core/css to render garden style vector as a String.

    (derive PersistentVector ::vector)
    (defmethod render-style ::vector [v] (css v))

    (defwebcomponent ex-style-garden
      :content [:button "Hello garden!"]
      :style [:button {:background "#3d7c45" :color "white" :border "0" :border-radius "4px"}])
                </code>
              </pre>
            </section>

            <section>
              <h4 id="custom-element-style-scope">Style scope</h4>
              <p>
                By default global styles are not applied to the Shadow DOM (concept of shadow boundary). <strong>apply-author-styles</strong> and <strong>reset-style-inheritance</strong> allow to control this behaviour. Check this <a href="http://www.html5rocks.com/en/tutorials/webcomponents/shadowdom-201/#style-inherit-cheetsheet">cheatsheet</a> for a comprehensive explanation.
              </p>
              <div class="example-live">
                <ex-style-scope></ex-style-scope>
              </div>
              <pre class="example-cljs">
                <code class="language-clojure">
    (defwebcomponent ex-style-scope
      :content [:span {:class "icon-exclamation-sign"} "Hello style scope!"]
      :apply-author-styles true)
                </code>
              </pre>
            </section>

          </section>

          <section id="custom-element-attributes">
            <h2>Attributes</h2>
            <p>
              Attributes declared via <strong>attributes</strong> are accessible via regular <strong>hasAttribute</strong> / <strong>getAttribute</strong> / <strong>removeAttribute</strong> at the node level as well as <strong>property</strong> on the element itself.
            </p>
            <div class="example-live">
              <ex-attributes id="ex-attributes"></ex-attributes>
              <button onclick="toggle()">Toggle attribute</button>
              <script>
                function toggle() {
                  var el = document.getElementById('ex-attributes');
                  var value = el.attribute;
                  if (value != null) {
                    el.attribute = null;
                  } else {
                    el.attribute = Math.random();
                  }
                }
              </script>
            </div>
            <pre class="example-markup">
              <code class="language-markup">
              </code>
            </pre>
            <pre class="example-cljs">
              <code class="language-clojure">
   (defn alert
     [el]
     (.alert js/window (str "Hello " el " !")))

   (defwebcomponent ex-attributes
    :attributes #{:attribute})
              </code>
            </pre>
          </section>

          <section id="custom-element-methods">
            <h2>Methods</h2>
            <p>
              Regular ClojureScript functions can directly manipulate element instances. You can also expose those functions to JavaScript users by explicitely listing those functions and assigning them a name that will be attached to the element prototype.
              <br>
              Note that ClojureScript functions will receive the right element instance as first parameter when invoked as a result of the invocation of the associated JavaScript method.
            </p>
            <div class="example-live">
              <ex-methods id="ex-methods"></ex-methods>
              <button onclick="document.getElementById('ex-methods').method()">Call alert</button>
            </div>
            <pre class="example-markup">
              <code class="language-markup">
  &lt;ex-methods id="ex-methods"&gt;&lt;/ex-methods&gt;
  &lt;button onclick="document.getElementById('ex-methods').method()"&gt;Call alert&lt;/button&gt;
              </code>
            </pre>
            <pre class="example-cljs">
              <code class="language-clojure">
   (defn alert
     [el]
     (.alert js/window (str "Hello " el " !")))

   (defwebcomponent ex-methods
    :methods {:method alert})
              </code>
            </pre>
          </section>

          <section id="custom-element-events">
            <h2>Events</h2>
            <p>
              Custom events can be created and dispatched as with regular elements. <strong>lucuma.event.fire</strong> can be used to simplify event firing.
            </p>
            <div class="example-live">
              <ex-events id="ex-events"></ex-events>
              <div class="btn-group" style="float: left;">
                <button type="button" class="btn btn-default" onclick="fireJS()">Fire event via JS</button>
                <button type="button" class="btn btn-default" onclick="fireCLJS()">Fire event via CLJS</button>
                <button id="btn-add-event" type="button" class="btn btn-success" onclick="addListener()" disabled>Add listener</button>
                <button id="btn-remove-event" type="button" class="btn btn-danger" onclick="removeListener()">Remove listener</button>
              </div>
              <ul id="lifecycle-events" style="height: 40px; width: 200px; overflow-y: auto;"></ul>
              <script>
                function onEvent(evt) {
                  alert(evt.detail.msg);
                }
                function fireJS() {
                  var event = new CustomEvent('event', {detail: {msg: 'Sent from JS'}});
                  document.getElementById('ex-events').dispatchEvent(event);
                }
                function fireCLJS() {
                  lucuma.examples.fire_event('#ex-events');
                }
                function addListener() {
                  document.getElementById('ex-events').addEventListener('event', onEvent, false);
                  document.getElementById('btn-add-event').disabled = true;
                  document.getElementById('btn-remove-event').disabled = false;
                }
                function removeListener() {
                  document.getElementById('ex-events').removeEventListener('event', onEvent, false);
                  document.getElementById('btn-add-event').disabled = false;
                  document.getElementById('btn-remove-event').disabled = true;
                }

                addListener();
              </script>
            </div>

            <section>
              <h4 id="custom-element-events-handlers">Event handlers</h4>
              <p>
                 Starting DOM level 2 events are preferably intercepted via <strong>addEventListener</strong> /<strong>removeEventListener</strong>. Each handler defined via <strong>handlers</strong> will be exposed as DOM level 1 style handlers (i.e. as on<strong>event</strong> property).
              </p>
              <div class="example-live">
                <ex-events id="ex-handlers" onevent="onEventHandler"></ex-events>
                <script>
                  function onEventHandler(evt) {
                    alert(evt.detail);
                  }
                  function fireHandler() {
                    var event = new CustomEvent('event', {detail: 'Event received by handler'});
                    document.getElementById('ex-handlers').dispatchEvent(event);
                  }
                  function addHandler() {
                    document.getElementById('ex-handlers').onevent = 'onEventHandler';
                    document.getElementById('btn-add-handler').disabled = true;
                    document.getElementById('btn-remove-handler').disabled = false;
                  }
                  function removeHandler() {
                    document.getElementById('ex-handlers').onevent = null;
                    document.getElementById('btn-add-handler').disabled = false;
                    document.getElementById('btn-remove-handler').disabled = true;
                  }
                </script>
                <div class="btn-group" style="float: left;">
                  <button type="button" class="btn btn-default" onclick="fireHandler()">Fire event</button>
                  <button id="btn-add-handler" type="button" class="btn btn-success" onclick="addHandler()" disabled>Add handler</button>
                  <button id="btn-remove-handler" type="button" class="btn btn-danger" onclick="removeHandler()">Remove handler</button>
                </div>
                <ul id="lifecycle-events" style="height: 40px; width: 200px; overflow-y: auto;"></ul>
              </div>
              <pre class="example-cljs">
                <code class="language-clojure">
   (defwebcomponent ex-handlers
    :handlers #{:event})
                </code>
              </pre>
            </section>

          </section>

          <section id="custom-element-constructor">
            <h2>Constructor</h2>
            <p>
              New instances of an element can be created using a JavaScript constructor available in the namespace defining the element. Constructor name can be provided via the <strong>constructor</strong> key. When not provided a default name is generated based on the element name (e.g. <strong>EXMyElement</strong> if the tag name is <strong>ex-my-element</strong>). No constructor is registered when <strong>constructor</strong> is set to <strong>nil</strong>.
            </p>
            <div class="example-live">
              <script>
                document.addEventListener('DOMContentLoaded', function() {
                  var el = new lucuma.examples.CustomConstructor();
                  document.querySelector('#custom-element-constructor .example-live').appendChild(el);
                });
              </script>
            </div>
            <pre class="example-markup">
              <code class="language-markup">
  &lt;script&gt;
    var el = new lucuma.examples.CustomConstructor();
    document.querySelector("#custom-element-constructor .example-live").appendChild(el);
  &lt;/script&gt;
              </code>
            </pre>
            <pre class="example-cljs">
              <code class="language-clojure">
   (defwebcomponent ex-constructor
    :constructor "CustomConstructor"
    :content [:div "Hello constructor!"])
              </code>
            </pre>
          </section>

          <section id="custom-element-extend">
            <h2>Extension</h2>
            <p>
              Existing element can be extended to inherit capacity from another element (via prototype inheritence). <strong>base-type</strong> value must be a valid tag name. When not provided the element prototype will extend HTMLElement.
            </p>
            <div class="example-live">
              <button is="ex-extend">Hello extended!</button>
            </div>
            <pre class="example-markup">
              <code class="language-markup">
  &lt;button is="ex-extend"&gt;Hello extended!&lt;/button&gt;
              </code>
            </pre>
            <pre class="example-cljs">
              <code class="language-clojure">
   (defwebcomponent ex-extend
    :base-type :button
    :content [:span {:class "icon-exclamation-sign"} [:content]]
    :style [:button {:color "red"}]
    :apply-author-styles true)
              </code>
            </pre>
          </section>

      </section>

      <section id="examples" class="main-section">
        <h1>Examples</h1>
        <p>All examples sources can be found <a href="https://github.com/jeluard/lucuma/tree/master/examples/lucuma">here</a>.</p>

        <section id="example-range-with-threshold">
          <h2>Range with threshold</h2>
          <div class="example-live">
            <input id="lucu-range-with-threshold" is="lucu-range-with-threshold" type="range" value="25" min="0" max="50" step="5"/>
            <span>Value: </span><span id="lucu-range-with-threshold-value" style="color: green"></span>
            <script>
              var el = document.getElementById('lucu-range-with-threshold');
              var valueEl = document.getElementById('lucu-range-with-threshold-value');
              valueEl = valueEl.impl != null ? valueEl.impl : valueEl;
              valueEl.innerHTML = el.value;
              el.addEventListener('threshold-cross', function(evt) {
                valueEl.style.color = (evt.detail.type === "breached") ? "red" : "green";
              }, false);
              el.addEventListener('change', function(evt) {
                var evt = evt.impl != null ? evt.impl : evt;
                valueEl.innerHTML = evt.target.value;
              }, false);
            </script>
          </div>
          <pre class="example-markup">
            <code class="language-markup">
            </code>
          </pre>
          <pre class="example-cljs">
            <code class="language-clojure">
            </code>
          </pre>
        </section>

        <section id="example-overlay">
          <h2>Overlay</h2>
          <p>Adpated from bee's <a href="https://github.com/blossom/bee/blob/master/lib/components/overlay.dart">overlay</a></p>
          <div class="example-live">
            <lucu-overlay id="overlay">
              <h4>Title</h4>
              <div>Some content</div>
            </lucu-overlay>
            <button onclick="document.getElementById('overlay').show()">Show overlay</button>
          </div>
          <pre class="example-markup">
            <code class="language-markup">
  &lt;lucu-overlay id="overlay"&gt;
    &lt;h4&gt;Title&lt;/h4&gt;
    &lt;div&gt;Some content&lt;/div&gt;
  &lt;/lucu-overlay&gt;
  &lt;button onclick="document.getElementById('overlay').show()">Show overlay&lt;/button&gt;
            </code>
          </pre>
          <pre class="example-cljs">
            <code class="language-clojure">
            </code>
          </pre>
        </section>

        <!--section id="example-flipbox">
          <h2>Flipbox</h2>
          <p>Adpated from brick's <a href="https://github.com/x-tag/flipbox">flipbox</a></p>
          <div class="example-live">
            <lucu-flipbox id="flipbox">
              <div>This is front</div>
              <div>This is back</div>
            </lucu-flipbox>
            <div class="btn-group">
              <button type="button" class="btn btn-default" onclick="toggle()">Toggle</button>
              <button id="btn-flipbox-front" type="button" class="btn btn-default" onclick="showFront()" disabled>Show front</button>
              <button id="btn-flipbox-back" type="button" class="btn btn-default" onclick="showBack()">Show back</button>
            </div>
            <script>
              function toggleButton(btn) {
                btn.disabled == true ? btn.disabled = false : btn.disabled = true;
              }
              function toggleButtons() {
                toggleButton(document.getElementById('btn-flipbox-front'));
                toggleButton(document.getElementById('btn-flipbox-back'));
              }
              function toggle() {
                document.getElementById('flipbox').toggle();
                toggleButtons();
              }
              function showFront() {
                document.getElementById('flipbox').showFront();
                toggleButtons();
              }
              function showBack() {
                document.getElementById('flipbox').showBack();
                toggleButtons();
              }
            </script>
          </div>
          <pre class="example-markup">
            <code class="language-markup">
  &lt;lucu-flipbox id="flipbox"&gt;
    &lt;div&gt;This is front&lt;/div&gt;
    &lt;div&gt;This is back&lt;/div&gt;
  &lt;/lucu-flipbox&gt;
  &lt;span class="btn-group"&gt;
    &lt;button type="button" class="btn btn-default" onclick="document.getElementById('flipbox').toggle()"&gt;Toggle&lt;/button&gt;
    &lt;button type="button" class="btn btn-default" onclick="document.getElementById('flipbox').showFront()"&gt;Show front&lt;/button&gt;
    &lt;button type="button" class="btn btn-default" onclick="document.getElementById('flipbox').showBack()"&gt;Show back&lt;/button&gt;
  &lt;/span&gt;
            </code>
          </pre>
          <pre class="example-cljs">
            <code class="language-clojure">
            </code>
          </pre>
        </section-->

        <script>
          function appendExampleUsage(usages) {
            fetchExample("examples", function(c) {
              var contentArray = c.split('\n');
              for (var i = 0; i < usages.length; i++) {
                var usage = usages[k];
                var selector = '#' + usage.id + ' .example-cljs code';
                var example = document.querySelector(selector);
                if (example != null) {
                  example.innerHTML = contentArray.slice(usage.lines[0] - 1, usage.lines[1]).join('\n');
                  Prism.highlightElement(example);
                }
              }
            });
          }

          function appendExample(id, name) {
            var selector = '#' + id + ' .example-cljs code';
            var example = document.querySelector(selector);
            if (example == null) {
              return;
            }

            fetchExample(name, function (c) {
              example.innerHTML = c;
              Prism.highlightElement(example);
            });
          }

          function fetchExample(name, fn) {
            var owner = 'jeluard';
            var repo = 'lucuma';
            var url_sha = 'https://api.github.com/repos/' + owner + '/' + repo + '/contents/examples/lucuma/' + name + '.cljs';
            var xhr_sha = new XMLHttpRequest();
            xhr_sha.onreadystatechange = function() {
              if (xhr_sha.readyState == 4 && xhr_sha.status == 200) {
                var name = JSON.parse(xhr_sha.responseText).sha;
                var url = 'https://api.github.com/repos/' + owner + '/' + repo + '/git/blobs/' + name;
                var xhr = new XMLHttpRequest();
                xhr.onreadystatechange = function() {
                  if (xhr.readyState == 4 && xhr.status == 200) {
                    fn(window.atob(JSON.parse(xhr.responseText).content.replace(/\n/g, '')));
                  }
                };
                xhr.open('GET', url, true);
                xhr.send(null);
              }
            };
            xhr_sha.open('GET', url_sha, true);
            xhr_sha.send(null);
          }

          appendExample('example-range-with-threshold', 'range_with_threshold');
          appendExample('example-overlay', "overlay");
          appendExample('example-flipbox', "flipbox");

          appendExampleUsage([{id: '#custom-element-definition', lines: [13, 14]},
                              {id: '#custom-element-lifecycle', lines: [16, 19]},
                              {id: '#custom-element-content', line: [13, 14]},
                              {id: '#custom-element-content-template-support', lines: [21, 22]},
                              {id: '#custom-element-content-custom-logic', lines: [24, 28]},
                              {id: '#custom-element-style', lines: [30, 32]},
                              {id: '#custom-element-style-custom-logic', lines: [34, 38]},
                              {id: '#custom-element-style-scope', lines: [40, 42]},
                              {id: '#custom-element-attributes', lines: [44, 52]},
                              {id: '#custom-element-methods', lines: [54, 59]},
                              {id: '#custom-element-constructor', lines: [61, 63]},
                              {id: '#custom-element-extend', lines: [65, 69]}]);
        </script>
      </section>

      <section id="tests" class="main-section" >
        <h1>Tests</h1>
        <script>
        function run_all_tests() {
          lucuma.test.browser_runner.run_all_tests();
        }
        </script>
        <button id="tests-btn" type="button" class="btn btn-primary ladda-button" data-style="expand-out" onclick="run_all_tests()">
          <span class="ladda-label">Run tests</span>
          <span class="ladda-spinner"></span>
        </button>
        <div id="tests-results"></div>
      </section>
    
      <section id="native-browser-support" class="main-section">
        <h1>Native browser support</h1>
        <p>
          Browsers are implementing Web Components technologies furiously those days. Still you might have to enable their support manually.
          <br>
          Check browser progress on <a href="http://caniuse.com/shadowdom">Shadow DOM</a>.
        </p>
        <ul class="nav nav-tabs">
          <li class="active"><a href="#chrome" data-toggle="tab">Chrome</a></li>
          <li><a href="#chrome-canary" data-toggle="tab">Chrome Canary</a></li>
          <li><a href="#firefox" data-toggle="tab">Firefox</a></li>
        </ul>
        <div class="tab-content">
          <div id="chrome" class="row tab-pane active">
            <a href="https://www.google.com/intl/en/chrome/browser/" class="col-md-3">
              <img class="browser-logo" src="assets/chrome.png">
            </a>
            <div class="col-md-9 browser-description">
              <p>Check chrome progress on <a href="http://www.chromium.org/blink/web-components">Web components</a>, <a href="http://www.chromestatus.com/features/4642138092470272">Custom Elements</a> and <a href="http://www.chromestatus.com/features/5479141319114752">Shadow DOM</a>.</p>
              <p>To enable native support:</p>
              <ol>
                <li>Open <strong>chrome://flags/#enable-experimental-webkit-features</strong></li>
                <li>Click the <em>Enable</em> link within that section</li>
                <li>Click the <em>Relaunch Now</em> button at the bottom of the window</li>
              </ol>
            </div>
          </div>
          <div id="chrome-canary" class="row tab-pane">
            <a href="https://www.google.com/intl/en/chrome/browser/canary.html" class="col-md-3">
              <img class="browser-logo" src="assets/chrome-canary.png">
            </a>
            <div class="col-md-9 browser-description">
              <p>Check chrome progress on <a href="http://www.chromium.org/blink/web-components">Web components</a>, <a href="http://www.chromestatus.com/features/4642138092470272">Custom Elements</a> and <a href="http://www.chromestatus.com/features/5479141319114752">Shadow DOM</a>.</p>
              <p>To enable native support:</p>
              <ol>
                <li>Open <strong>chrome://flags/#enable-experimental-web-platform-features</strong></li>
                <li>Click the <em>Enable</em> link within that section</li>
                <li>Click the <em>Relaunch Now</em> button at the bottom of the window</li>
              </ol>
            </div>
          </div>
          <div id="firefox" class="row tab-pane">
            <a href="http://www.mozilla.org/firefox/new/" class="col-md-3">
              <img class="browser-logo" src="assets/firefox.png">
            </a>
            <div class="col-md-9 browser-description">
              <p>Check firefox progress on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=856140">Custom Elements</a> and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=806506">Shadow DOM</a>.</p>
              <p>All features are enabled by default.</p>
            </div>
          </div>
        </div>
      </section>

      <section id="links" class="main-section">
        <h1>Links</h1>

        <h3>Introdution</h3>
        <ul>
          <li><a href="https://dvcs.w3.org/hg/webcomponents/raw-file/tip/explainer/index.html">W3C Introduction to Web Components</a></li>
          <li><a href="http://webcomponentsshift.com">webcomponentsshift.com</a></li>
          <li><a href="https://speakerdeck.com/stopsatgreen/web-components-getting-started">Getting started</a></li>
        </ul>

        <h3>Web Components library</h3>
        <ul>
          <li><a href="http://mozilla.github.io/brick/">Brick</a></li>
          <li><a href="http://registry.x-tags.org/">X-Tags</a></li>
          <li><a href="http://www.polymer-project.org/docs/elements/">Polymer</a></li>
          <li><a href="http://customelements.io/">CustomElements.io</a></li>
        </ul>

        <h3>To go further</h3>
        <ul>
          <li><a href="http://www.html5rocks.com/en/tutorials/webcomponents/customelements/">Custom Elements</a></li>
          <li><a href="http://www.html5rocks.com/en/tutorials/webcomponents/shadowdom/">Shadow DOM 101</a></li>
          <li><a href="http://www.html5rocks.com/en/tutorials/webcomponents/shadowdom-201/">Shadow DOM 201</a></li>
          <li><a href="http://www.html5rocks.com/en/tutorials/webcomponents/shadowdom-301/">Shadow DOM 301</a></li>
          <li><a href="http://www.html5rocks.com/en/tutorials/webcomponents/template/">Template</a></li>
        </ul>

        <h3>Specifications</h3>
        <ul>
          <li><a href="https://dvcs.w3.org/hg/webcomponents/raw-file/tip/spec/custom/index.html">Custom Elements</a></li>
          <li><a href="https://dvcs.w3.org/hg/webcomponents/raw-file/tip/spec/shadow/index.html">Shadow DOM</a></li>
          <li><a href="https://dvcs.w3.org/hg/webcomponents/raw-file/tip/spec/templates/index.html">HTML Template</a></li>
        </ul>

      </section>

      <script>
        lucuma.examples.register_all();
      </script>
    </main>

    <footer>
      Copyright © 2013 Julien Eluard - Distributed under the <a href="http://www.eclipse.org/legal/epl-v10.html">Eclipse Public License</a>, the same as Clojure.
    </footer>

  </body>
</html>
